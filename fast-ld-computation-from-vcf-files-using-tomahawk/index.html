<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Fast LD computation from VCF files using Tomahawk • rmf</title>
<meta name="description" content="Fast LD computation from a VCF file using vcftools, bcftools and tomahawk. This avoids the use of PLINK or conversion to PLINK formats.">


  <meta name="author" content="Roy Francis">
  
  <meta property="article:author" content="Roy Francis">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="rmf">
<meta property="og:title" content="Fast LD computation from VCF files using Tomahawk">
<meta property="og:url" content="https://royfrancis.com/fast-ld-computation-from-vcf-files-using-tomahawk/">


  <meta property="og:description" content="Fast LD computation from a VCF file using vcftools, bcftools and tomahawk. This avoids the use of PLINK or conversion to PLINK formats.">







  <meta property="article:published_time" content="2018-12-01T13:45:07+01:00">





  

  


<link rel="canonical" href="https://royfrancis.com/fast-ld-computation-from-vcf-files-using-tomahawk/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Roy Francis",
      "url": "https://royfrancis.com/"
    
  }
</script>


  <meta name="google-site-verification" content="google-site-verification=gVz_q-4FyIIzjgUOs8-zItaFtLDCqCLhiHAAfkGb808" />






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="rmf Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->




    <link rel="apple-touch-icon"  type="image/png"   sizes="180x180"   href="/assets/images/apple-touch-icon.png">

    <link rel="icon"  type="image/png"   sizes="48x48"   href="/assets/images/favicon-48x48.png">

    <link rel="icon"  type="image/png"   sizes="32x32"   href="/assets/images/favicon-32x32.png">

    <link rel="icon"  type="image/png"   sizes="16x16"   href="/assets/images/favicon-16x16.png">

    <link rel="shortcut icon"   sizes="2"   href="/assets/images/favicon.ico">

    <link rel="manifest"   sizes="2"   href="/assets/images/site.webmanifest">

    <link rel="mask-icon"   sizes="3"   color="#5bbad5"  href="/assets/images/safari-pinned-tab.svg">



<meta name="msapplication-config" content="/assets/images/browserconfig.xml">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<link href="https://fonts.googleapis.com/css?family=Merriweather:400,700|Source+Sans+Pro:400,400i,600|Ubuntu+Mono&display=swap&subset=latin-ext" rel="stylesheet" type="text/css">

<!-- end custom head snippets -->




    <script src="/assets/js/simplelightbox.js"></script>

    <script src="/assets/js/code-copy.js"></script>



    <link href="/assets/css/simplelightbox.css" rel="stylesheet">

  </head>

  <body class="layout--single-mx wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/android-chrome-192x192.png" alt="rmf"></a>
        
        <a class="site-title" href="/">
          rmf
          <span class="site-subtitle">Code, Photography, Design</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/posts/">Blog</a>
            </li><li class="masthead__menu-item">
              <a href="/projects/">Projects</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="parent-container">
      <div class="initial-content">
        



<div class="featured">
  <img src=/assets/images/posts/2018/2018-12-01-fast-ld-computation-from-vcf-files-using-tomahawk/featured.png alt="featured-image" class="featured-image">
</div>



<div id="main-mx" role="main">
  


  <article class="page-mx h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    
    <meta itemprop="headline" content="Fast LD computation from VCF files using Tomahawk">
    
    <meta itemprop="description" content="Fast LD computation from a VCF file using vcftools, bcftools and tomahawk. This avoids the use of PLINK or conversion to PLINK formats.">
    
    <meta itemprop="datePublished" content="2018-12-01T13:45:07+01:00">
    

    <div class="page__inner-wrap">
      
      <header>
        <h1 id="page-title" class="page__title p-name" itemprop="headline">
          <a href="https://royfrancis.com/fast-ld-computation-from-vcf-files-using-tomahawk/" class="u-url" itemprop="url">Fast LD computation from VCF files using Tomahawk
</a>
        </h1>
        


      </header>
      

      <section class="page__content e-content" itemprop="text">

        <footer class="page__meta">
          
          <div class="meta-content">
  <div class="meta-content-sub">
  

  <span class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> </strong> <time class="dt-published" datetime="2018-12-01T13:45:07+01:00">01 Dec 2018</time></span>

  
  <span class="separator">
    •
  </span>
  
  
  


  

  <span>
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i>  </strong>
    <span itemprop="keywords" class="category-keywords">
    
      <a href="/categories/#code" class="page__taxonomy-item p-category taxonomy-category" rel="tag">Code</a><span class="sep">, </span>
    
      <a href="/categories/#research" class="page__taxonomy-item p-category taxonomy-category" rel="tag">Research</a>
    
    </span>
  </span>


</div>  
  
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i>  </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#genetics" class="page__taxonomy-item p-category taxonomy-tag" rel="tag">Genetics</a><span class="sep">, </span>
    
      <a href="/tags/#genomics" class="page__taxonomy-item p-category taxonomy-tag" rel="tag">Genomics</a><span class="sep">, </span>
    
      <a href="/tags/#linkage-disequilibirium" class="page__taxonomy-item p-category taxonomy-tag" rel="tag">Linkage Disequilibirium</a><span class="sep">, </span>
    
      <a href="/tags/#ngs" class="page__taxonomy-item p-category taxonomy-tag" rel="tag">NGS</a><span class="sep">, </span>
    
      <a href="/tags/#population-genetics" class="page__taxonomy-item p-category taxonomy-tag" rel="tag">Population Genetics</a><span class="sep">, </span>
    
      <a href="/tags/#r" class="page__taxonomy-item p-category taxonomy-tag" rel="tag">R</a><span class="sep">, </span>
    
      <a href="/tags/#snp" class="page__taxonomy-item p-category taxonomy-tag" rel="tag">SNP</a>
    
    </span>
  </p>


</div>
        </footer>

        
        <div class="toc-content">
          <div class="toc-content-child-left">
            <div class="article-content">
              <p>Install <strong>tomahawk</strong> from <a href="https://github.com/mklarqvist/tomahawk">here</a>. Following commands are run on the Linux command-line.</p>

<h2 id="thinning-vcf">Thinning VCF</h2>

<p>For LD computation, pairwise comparisons are performed between all SNPs, therefore it is essential to thin down the number of SNPs. My dataset has about 18 million SNPs. My aim is to bring it down to 20,000 or so. Use <strong>vcftools</strong> to thin down a VCF file.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vcftools <span class="nt">--vcf</span> snp.vcf <span class="nt">--recode</span> <span class="nt">--recode-INFO-all</span> <span class="nt">--thin</span> 50000 <span class="nt">--out</span> <span class="s2">"snp-thin"</span>

VCFtools - 0.1.15
<span class="o">(</span>C<span class="o">)</span> Adam Auton and Anthony Marcketta 2009

Parameters as interpreted:
        <span class="nt">--vcf</span> snp.vcf
        <span class="nt">--recode-INFO-all</span>
        <span class="nt">--thin</span> 50000
        <span class="nt">--out</span> snp-thin
        <span class="nt">--recode</span>

After filtering, kept 64 out of 64 Individuals
Outputting VCF file...
After filtering, kept 26205 out of a possible 18793942 Sites
Run Time <span class="o">=</span> 135.00 seconds

<span class="nb">mv</span> <span class="s2">"snp-thin.recode.vcf"</span> <span class="s2">"snp-thin.vcf"</span>
</code></pre></div></div>

<p>The argument <code class="language-plaintext highlighter-rouge">--thin 50000</code> means to keep 1 SNP every 50,000 bases. Depending on the number of SNPs in the VCF file, you want to increase or decrease this. I am aiming for about 20,000 or so SNPs in the thinned file.</p>

<h2 id="vcf-to-bcf">VCF to BCF</h2>

<p>Convert VCF to BCF.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bcftools view snp.vcf <span class="nt">-O</span> b <span class="nt">-o</span> snp.bcf
</code></pre></div></div>

<h2 id="tomahawk">Tomahawk</h2>

<p>Instructions on using <strong>tomahawk</strong> is detailed <a href="https://github.com/mklarqvist/tomahawk">here</a>. Convert BCF to the tomahawk format. Import filters filter out sites with missingness &gt; 20% and HW p-value &lt; 0.001.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tomahawk import <span class="nt">-i</span> snp.bcf <span class="nt">-o</span> snp <span class="nt">-m</span> 0.2 <span class="nt">-h</span> 0.001
</code></pre></div></div>

<p><strong>Tomahawk</strong> is used to compute LD.</p>

<p>Arguments: <code class="language-plaintext highlighter-rouge">-u</code> (unphased), <code class="language-plaintext highlighter-rouge">-d</code> (progress), <code class="language-plaintext highlighter-rouge">-f</code> (fast computation), <code class="language-plaintext highlighter-rouge">-i</code> (input file), <code class="language-plaintext highlighter-rouge">-o</code> (output file name prefix), <code class="language-plaintext highlighter-rouge">-r</code> (min R2 cut-off). See tomahawk <a href="https://www.biostars.org/p/347796/(https://github.com/mklarqvist/tomahawk)">help</a> for more descriptions.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tomahawk calc <span class="nt">-udfi</span> snp.twk <span class="nt">-o</span> snp <span class="nt">-a</span> 5 <span class="nt">-r</span> 0.1 <span class="nt">-P</span> 0.1 <span class="nt">-C</span> 1 <span class="nt">-t</span> 1
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">.two</code> output is binary and needs to be exported to a text file. The <code class="language-plaintext highlighter-rouge">-I</code> arguments restricts the output to a specified chromosome. So, <code class="language-plaintext highlighter-rouge">-I chr1</code> (UCSC) of <code class="language-plaintext highlighter-rouge">-I 1</code> (Ensembl) exports only chromosome 1. It is probably better to have separate files for each chromosome as the files are a more managable size to read into R. The LD metrics are computed between SNPs within chromosomes anyway.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tomahawk view <span class="nt">-i</span> snp.two <span class="o">&gt;</span> snp.ld
tomahawk view <span class="nt">-i</span> snp.two <span class="nt">-I</span> 1 <span class="o">&gt;</span> snp-1.ld
</code></pre></div></div>

<h2 id="plotting">Plotting</h2>

<p>Now we move into <strong>R</strong>. First we load some libraries and define some plotting functions to be used later.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load libraries</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">

</span><span class="c1"># define plotting functions</span><span class="w">
</span><span class="cd">#' @title plotPairwiseLD</span><span class="w">
</span><span class="cd">#' @description Plots R2 heatmap across the chromosome (like Haploview)</span><span class="w">
</span><span class="cd">#' @param dfr A data.frame with minimum CHROM_A, POS_A, CHROM_B, POS_B and R2.</span><span class="w">
</span><span class="cd">#' An output from tomahawk works.</span><span class="w">
</span><span class="cd">#' @param chr A chromosome name.</span><span class="w">
</span><span class="cd">#' @param xlim A two number vector specifying min and max x-axis limits. Any one or both can be defaulted by specifying NA.</span><span class="w">
</span><span class="cd">#' @param ylim A two number vector specifying min and max y-axis limits. Any one or both can be defaulted by specifying NA.</span><span class="w">
</span><span class="cd">#' @param minr2 A value between 0 and 1. All SNPs with R2 value below this</span><span class="w">
</span><span class="cd">#' value is excluded from plot.</span><span class="w">
</span><span class="cd">#'</span><span class="w">
</span><span class="n">plotPairwiseLD</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">dfr</span><span class="p">,</span><span class="w"> </span><span class="n">chr</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">),</span><span class="w"> </span><span class="n">minr2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">missing</span><span class="p">(</span><span class="n">dfr</span><span class="p">))</span><span class="w"> </span><span class="n">stop</span><span class="p">(</span><span class="s2">"Input data.frame 'dfr' missing."</span><span class="p">)</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">missing</span><span class="p">(</span><span class="n">chr</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">ld</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">CHROM_A</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="s2">"chr"</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">CHROM_B</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="s2">"chr"</span><span class="p">))</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="n">ld</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">POS_A</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">POS_B</span><span class="p">)</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">missing</span><span class="p">(</span><span class="n">minr2</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">ld</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">R2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="s2">"minr2"</span><span class="p">))</span><span class="w">
  </span><span class="p">}</span><span class="w">

  </span><span class="n">ld</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ld</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">arrange</span><span class="p">(</span><span class="n">R2</span><span class="p">)</span><span class="w">

  </span><span class="n">ld</span><span class="o">$</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ld</span><span class="o">$</span><span class="n">POS_A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">ld</span><span class="o">$</span><span class="n">POS_B</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ld</span><span class="o">$</span><span class="n">POS_A</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
  </span><span class="n">ld</span><span class="o">$</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ld</span><span class="o">$</span><span class="n">POS_B</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ld</span><span class="o">$</span><span class="n">POS_A</span><span class="w">
  </span><span class="n">ld</span><span class="o">$</span><span class="n">r2c</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cut</span><span class="p">(</span><span class="n">ld</span><span class="o">$</span><span class="n">R2</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0.2</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w">
    </span><span class="s2">"0-0 - 0.2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"0.2 - 0.4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"0.4 - 0.6"</span><span class="p">,</span><span class="w"> </span><span class="s2">"0.6 - 0.8"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"0.8 - 1.0"</span><span class="w">
  </span><span class="p">))</span><span class="w">
  </span><span class="n">ld</span><span class="o">$</span><span class="n">r2c</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">ld</span><span class="o">$</span><span class="n">r2c</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rev</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="w">
    </span><span class="s2">"0-0 - 0.2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"0.2 - 0.4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"0.4 - 0.6"</span><span class="p">,</span><span class="w"> </span><span class="s2">"0.6 - 0.8"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"0.8 - 1.0"</span><span class="w">
  </span><span class="p">)))</span><span class="w">

  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2c</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_point</span><span class="p">(</span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"#ca0020"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#f4a582"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#d1e5f0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#67a9cf"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#2166ac"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">limits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xlim</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">limits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ylim</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">guides</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guide_legend</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"R2"</span><span class="p">,</span><span class="w"> </span><span class="n">override.aes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Chromosome (Bases)"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme_bw</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme</span><span class="p">(</span><span class="w">
      </span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
      </span><span class="n">axis.ticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">()</span><span class="w">
    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="nf">return</span><span class="p">()</span><span class="w">
</span><span class="p">}</span><span class="w">


</span><span class="cd">#' @title plotDecayLD</span><span class="w">
</span><span class="cd">#' @description Plots R2 heatmap across the chromosome (like Haploview)</span><span class="w">
</span><span class="cd">#' @param dfr A data.frame with minimum CHROM_A, POS_A, CHROM_B, POS_B and R2.</span><span class="w">
</span><span class="cd">#' An output from tomahawk works.</span><span class="w">
</span><span class="cd">#' @param chr A chromosome name.</span><span class="w">
</span><span class="cd">#' @param xlim A two number vector specifying min and max x-axis limits. Any one or both can be defaulted by specifying NA.</span><span class="w">
</span><span class="cd">#' @param ylim A two number vector specifying min and max y-axis limits.  Any one or both can be defaulted by specifying NA.</span><span class="w">
</span><span class="cd">#' @param avgwin An integer specifying window size. Mean R2 is computed within windows.</span><span class="w">
</span><span class="cd">#' @param minr2 A value between 0 and 1. All SNPs with R2 value below this</span><span class="w">
</span><span class="cd">#' value is excluded from plot.</span><span class="w">
</span><span class="cd">#'</span><span class="w">
</span><span class="n">plotDecayLD</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">dfr</span><span class="p">,</span><span class="w"> </span><span class="n">chr</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">),</span><span class="w"> </span><span class="n">avgwin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">minr2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">missing</span><span class="p">(</span><span class="n">dfr</span><span class="p">))</span><span class="w"> </span><span class="n">stop</span><span class="p">(</span><span class="s2">"Input data.frame 'dfr' missing."</span><span class="p">)</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">missing</span><span class="p">(</span><span class="n">chr</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">ld</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">CHROM_A</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="s2">"chr"</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">CHROM_B</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="s2">"chr"</span><span class="p">))</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="n">ld</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">POS_A</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">POS_B</span><span class="p">)</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">missing</span><span class="p">(</span><span class="n">minr2</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">ld</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">R2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="s2">"minr2"</span><span class="p">))</span><span class="w">
  </span><span class="p">}</span><span class="w">

  </span><span class="n">ld</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ld</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">arrange</span><span class="p">(</span><span class="n">R2</span><span class="p">)</span><span class="w">

  </span><span class="n">ld</span><span class="o">$</span><span class="n">dist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ld</span><span class="o">$</span><span class="n">POS_B</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ld</span><span class="o">$</span><span class="n">POS_A</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">avgwin</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">ld</span><span class="o">$</span><span class="n">distc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cut</span><span class="p">(</span><span class="n">ld</span><span class="o">$</span><span class="n">dist</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">ld</span><span class="o">$</span><span class="n">dist</span><span class="p">),</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">ld</span><span class="o">$</span><span class="n">dist</span><span class="p">),</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avgwin</span><span class="p">))</span><span class="w">
    </span><span class="n">ld</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ld</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">distc</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">dist</span><span class="p">),</span><span class="w"> </span><span class="n">R2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">R2</span><span class="p">))</span><span class="w">
  </span><span class="p">}</span><span class="w">

  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R2</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_point</span><span class="p">(</span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.15</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_smooth</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">limits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xlim</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">limits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ylim</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Distance (Bases)"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="n">LD</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="o">^</span><span class="p">{</span><span class="w">
      </span><span class="m">2</span><span class="w">
    </span><span class="p">})))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme_bw</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme</span><span class="p">(</span><span class="w">
      </span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
      </span><span class="n">axis.ticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">()</span><span class="w">
    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="nf">return</span><span class="p">()</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Then we read the file.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ld</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.delim</span><span class="p">(</span><span class="s2">"snp.ld"</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s2">"\t"</span><span class="p">,</span><span class="w"> </span><span class="n">comment.char</span><span class="o">=</span><span class="s2">"#"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>The output looks like below:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">ld</span><span class="p">)</span><span class="w">
  </span><span class="n">FLAG</span><span class="w"> </span><span class="n">CHROM_A</span><span class="w">   </span><span class="n">POS_A</span><span class="w"> </span><span class="n">CHROM_B</span><span class="w">   </span><span class="n">POS_B</span><span class="w">   </span><span class="n">REF_REF</span><span class="w">      </span><span class="n">REF_ALT</span><span class="w">   </span><span class="n">ALT_REF</span><span class="w">
</span><span class="m">1</span><span class="w">   </span><span class="m">10</span><span class="w">       </span><span class="m">1</span><span class="w">     </span><span class="m">359</span><span class="w">       </span><span class="m">1</span><span class="w">  </span><span class="m">100777</span><span class="w"> </span><span class="m">103.00000</span><span class="w"> </span><span class="m">8.526513e-14</span><span class="w">  </span><span class="m">5.000000</span><span class="w">
</span><span class="m">2</span><span class="w">   </span><span class="m">10</span><span class="w">       </span><span class="m">1</span><span class="w">  </span><span class="m">100777</span><span class="w">       </span><span class="m">1</span><span class="w">     </span><span class="m">359</span><span class="w"> </span><span class="m">103.00000</span><span class="w"> </span><span class="m">8.526513e-14</span><span class="w">  </span><span class="m">5.000000</span><span class="w">
</span><span class="m">3</span><span class="w">    </span><span class="m">2</span><span class="w">       </span><span class="m">1</span><span class="w">     </span><span class="m">359</span><span class="w">       </span><span class="m">1</span><span class="w">  </span><span class="m">452615</span><span class="w">  </span><span class="m">97.48765</span><span class="w"> </span><span class="m">5.512354e+00</span><span class="w"> </span><span class="m">10.512354</span><span class="w">
</span><span class="m">4</span><span class="w">    </span><span class="m">2</span><span class="w">       </span><span class="m">1</span><span class="w">  </span><span class="m">452615</span><span class="w">       </span><span class="m">1</span><span class="w">     </span><span class="m">359</span><span class="w">  </span><span class="m">97.48765</span><span class="w"> </span><span class="m">5.512354e+00</span><span class="w"> </span><span class="m">10.512354</span><span class="w">
</span><span class="m">5</span><span class="w">    </span><span class="m">6</span><span class="w">       </span><span class="m">1</span><span class="w">     </span><span class="m">359</span><span class="w">       </span><span class="m">1</span><span class="w"> </span><span class="m">1454410</span><span class="w">  </span><span class="m">49.07769</span><span class="w"> </span><span class="m">5.392231e+01</span><span class="w">  </span><span class="m">1.922308</span><span class="w">
</span><span class="m">6</span><span class="w">    </span><span class="m">6</span><span class="w">       </span><span class="m">1</span><span class="w"> </span><span class="m">1454410</span><span class="w">       </span><span class="m">1</span><span class="w">     </span><span class="m">359</span><span class="w">  </span><span class="m">49.07769</span><span class="w"> </span><span class="m">5.392231e+01</span><span class="w">  </span><span class="m">1.922308</span><span class="w">
    </span><span class="n">ALT_ALT</span><span class="w">          </span><span class="n">D</span><span class="w">    </span><span class="n">Dprime</span><span class="w">         </span><span class="n">R</span><span class="w">        </span><span class="n">R2</span><span class="w">            </span><span class="n">P</span><span class="w"> </span><span class="n">ChiSqModel</span><span class="w">
</span><span class="m">1</span><span class="w"> </span><span class="m">20.00000</span><span class="w"> </span><span class="m">0.12573242</span><span class="w"> </span><span class="m">1.0000000</span><span class="w"> </span><span class="m">0.8734775</span><span class="w"> </span><span class="m">0.7629629</span><span class="w"> </span><span class="m">4.440203e-19</span><span class="w">   </span><span class="m">2.296495</span><span class="w">
</span><span class="m">2</span><span class="w"> </span><span class="m">20.00000</span><span class="w"> </span><span class="m">0.12573242</span><span class="w"> </span><span class="m">1.0000000</span><span class="w"> </span><span class="m">0.8734775</span><span class="w"> </span><span class="m">0.7629629</span><span class="w"> </span><span class="m">4.440203e-19</span><span class="w">   </span><span class="m">2.296495</span><span class="w">
</span><span class="m">3</span><span class="w"> </span><span class="m">14.48765</span><span class="w"> </span><span class="m">0.08266716</span><span class="w"> </span><span class="m">0.6574848</span><span class="w"> </span><span class="m">0.5742982</span><span class="w"> </span><span class="m">0.3298184</span><span class="w"> </span><span class="m">5.573234e-08</span><span class="w">   </span><span class="m">1.993300</span><span class="w">
</span><span class="m">4</span><span class="w"> </span><span class="m">14.48765</span><span class="w"> </span><span class="m">0.08266716</span><span class="w"> </span><span class="m">0.6574848</span><span class="w"> </span><span class="m">0.5742982</span><span class="w"> </span><span class="m">0.3298184</span><span class="w"> </span><span class="m">5.573234e-08</span><span class="w">   </span><span class="m">1.993300</span><span class="w">
</span><span class="m">5</span><span class="w"> </span><span class="m">23.07769</span><span class="w"> </span><span class="m">0.06280179</span><span class="w"> </span><span class="m">0.8070154</span><span class="w"> </span><span class="m">0.3235735</span><span class="w"> </span><span class="m">0.1046998</span><span class="w"> </span><span class="m">1.876711e-04</span><span class="w">   </span><span class="m">7.703488</span><span class="w">
</span><span class="m">6</span><span class="w"> </span><span class="m">23.07769</span><span class="w"> </span><span class="m">0.06280179</span><span class="w"> </span><span class="m">0.8070154</span><span class="w"> </span><span class="m">0.3235735</span><span class="w"> </span><span class="m">0.1046998</span><span class="w"> </span><span class="m">1.876711e-04</span><span class="w">   </span><span class="m">7.703488</span><span class="w">
  </span><span class="n">ChiSqTable</span><span class="w">
</span><span class="m">1</span><span class="w">   </span><span class="m">97.65926</span><span class="w">
</span><span class="m">2</span><span class="w">   </span><span class="m">97.65926</span><span class="w">
</span><span class="m">3</span><span class="w">   </span><span class="m">42.21675</span><span class="w">
</span><span class="m">4</span><span class="w">   </span><span class="m">42.21675</span><span class="w">
</span><span class="m">5</span><span class="w">   </span><span class="m">13.40157</span><span class="w">
</span><span class="m">6</span><span class="w">   </span><span class="m">13.40157</span><span class="w">
</span></code></pre></div></div>

<p>Plot pairwise LD plot.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotPairwiseLD</span><span class="p">(</span><span class="n">ld</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<!-- https://stackoverflow.com/questions/7488393/jekyll-liquid-random-numbers -->

<figure class="fig" id="slb-2022011423360333036297223670"><a href="/assets/images/posts/2018/2018-12-01-fast-ld-computation-from-vcf-files-using-tomahawk/featured.png" title="Pairwise LD plot across a chromosome.">
      <img src="/assets/images/posts/2018/2018-12-01-fast-ld-computation-from-vcf-files-using-tomahawk/featured.png" alt="ld" />
    </a>
    <figcaption>
    Pairwise LD plot across a chromosome.

    </figcaption>

  

</figure>

<script type="text/javascript">
  new SimpleLightbox({elements: '#slb-2022011423360333036297223670 a'});
</script>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotPairwiseLD</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">minr2</span><span class="o">=</span><span class="m">0.2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<!-- https://stackoverflow.com/questions/7488393/jekyll-liquid-random-numbers -->

<figure class="fig" id="slb-20220114233603330362972123921"><a href="/assets/images/posts/2018/2018-12-01-fast-ld-computation-from-vcf-files-using-tomahawk/2.png" title="Pairwise LD plot with a min R2 limit of 0.2.">
      <img src="/assets/images/posts/2018/2018-12-01-fast-ld-computation-from-vcf-files-using-tomahawk/2.png" alt="ld-limit" />
    </a>
    <figcaption>
    Pairwise LD plot with a min R2 limit of 0.2.

    </figcaption>

  

</figure>

<script type="text/javascript">
  new SimpleLightbox({elements: '#slb-20220114233603330362972123921 a'});
</script>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotPairwiseLD</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">minr2</span><span class="o">=</span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="o">^</span><span class="m">7</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<!-- https://stackoverflow.com/questions/7488393/jekyll-liquid-random-numbers -->

<figure class="fig" id="slb-2022011423360333036297254383"><a href="/assets/images/posts/2018/2018-12-01-fast-ld-computation-from-vcf-files-using-tomahawk/3.png" title="Pairwise LD plot with a min R2 limit of 0.2 and y-axis max limit set to 10^7.">
      <img src="/assets/images/posts/2018/2018-12-01-fast-ld-computation-from-vcf-files-using-tomahawk/3.png" alt="ld-limit-y" />
    </a>
    <figcaption>
    Pairwise LD plot with a min R2 limit of 0.2 and y-axis max limit set to 10^7.

    </figcaption>

  

</figure>

<script type="text/javascript">
  new SimpleLightbox({elements: '#slb-2022011423360333036297254383 a'});
</script>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotDecayLD</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">minr2</span><span class="o">=</span><span class="m">0.25</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<!-- https://stackoverflow.com/questions/7488393/jekyll-liquid-random-numbers -->

<figure class="fig" id="slb-20220114233603330362972184335"><a href="/assets/images/posts/2018/2018-12-01-fast-ld-computation-from-vcf-files-using-tomahawk/4.png" title="LD decay plot with a min R2 limit of 0.25.">
      <img src="/assets/images/posts/2018/2018-12-01-fast-ld-computation-from-vcf-files-using-tomahawk/4.png" alt="ld-limit-y-1" />
    </a>
    <figcaption>
    LD decay plot with a min R2 limit of 0.25.

    </figcaption>

  

</figure>

<script type="text/javascript">
  new SimpleLightbox({elements: '#slb-20220114233603330362972184335 a'});
</script>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotDecayLD</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">minr2</span><span class="o">=</span><span class="m">0.25</span><span class="p">,</span><span class="w"> </span><span class="n">avgwin</span><span class="o">=</span><span class="m">100000</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<!-- https://stackoverflow.com/questions/7488393/jekyll-liquid-random-numbers -->

<figure class="fig" id="slb-2022011423360333036297252759"><a href="/assets/images/posts/2018/2018-12-01-fast-ld-computation-from-vcf-files-using-tomahawk/5.png" title="LD decay plot with a min R2 limit of 0.25 and R2 values averaged within 10 Kb windows.">
      <img src="/assets/images/posts/2018/2018-12-01-fast-ld-computation-from-vcf-files-using-tomahawk/5.png" alt="ld-limit-y-2" />
    </a>
    <figcaption>
    LD decay plot with a min R2 limit of 0.25 and R2 values averaged within 10 Kb windows.

    </figcaption>

  

</figure>

<script type="text/javascript">
  new SimpleLightbox({elements: '#slb-2022011423360333036297252759 a'});
</script>


            </div>
          </div>
          <div class="toc-content-child-right">
            <nav class="toc">
              <ul class="toc__menu"><li><a href="#thinning-vcf">Thinning VCF</a></li><li><a href="#vcf-to-bcf">VCF to BCF</a></li><li><a href="#tomahawk">Tomahawk</a></li><li><a href="#plotting">Plotting</a></li></ul>

            </nav>
          </div>
        </div>
        

        <div>
          <a href="#page-title" class="back-to-top">Back to top &uarr;</a>
        </div>
        
      </section>

      

      
  <nav class="pagination">
    
      <a href="/using-google-maps-for-aerial-photography/" class="pagination--pager" title="Using google maps for aerial photography
">Previous</a>
    
    
      <a href="/beautiful-circos-plots-in-r/" class="pagination--pager" title="Beautiful circos plots in R
">Next</a>
    
  </nav>

    </div>

    
    <div class="page__comments">
  
  
      <h4 class="page__comments-title">Comments</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
  <div class="page-related-mx">
    <h2 class="page__related-title">You may also enjoy</h2>
    <div class="grid__wrapper">
      
      





<div class="grid__item feed-item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    
      <div class="archive-featured-small feed-image">
        <img src=/assets/images/posts/2019/2019-11-07-greece-thessaloniki/featured.jpg alt="featured-image-small" class="archive-featured-image">
      </div>

      <div class="archive-text">
        <div class="archive-meta-content">
  <div class="archive-meta-content-sub">
    
    <!-- date -->
    
    
      <span class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> </strong> <time class="dt-published feed-date" datetime="2019-11-07T00:00:00+01:00">07 Nov 2019</time></span>
    

    <!-- separator-->
    
    <span class="separator">
      •
    </span>
    

    <!-- categories -->
      
      
      
    
    
      
    
      <span>
        <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i>  </strong>
        <span itemprop="keywords" class="category-keywords feed-category">
        
          <a href="/categories/#photography" class="page__taxonomy-item p-category taxonomy-category" rel="tag">Photography</a><span class="sep">, </span>
        
          <a href="/categories/#travel" class="page__taxonomy-item p-category taxonomy-category" rel="tag">Travel</a>
        
        </span>
      </span>
    


      
      
  </div>
</div>
        <h2 class="archive__item-title no_toc feed-title" itemprop="headline">
        
          <a href="/greece-thessaloniki/" rel="permalink">Exploring history and culture in Thessaloniki
</a>
        
        </h2>
        


        <p class="archive__item-excerpt feed-excerpt" itemprop="description">A short weekend away in Thessaloniki, Greece.
</p>
      </div>
  </article>
</div>

      
      





<div class="grid__item feed-item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    
      <div class="archive-featured-small feed-image">
        <img src=/assets/images/posts/2019/2019-09-17-scatterplot-annotation/featured.jpg alt="featured-image-small" class="archive-featured-image">
      </div>

      <div class="archive-text">
        <div class="archive-meta-content">
  <div class="archive-meta-content-sub">
    
    <!-- date -->
    
    
      <span class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> </strong> <time class="dt-published feed-date" datetime="2019-09-17T00:00:00+02:00">17 Sep 2019</time></span>
    

    <!-- separator-->
    
    <span class="separator">
      •
    </span>
    

    <!-- categories -->
      
      
      
    
    
      
    
      <span>
        <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i>  </strong>
        <span itemprop="keywords" class="category-keywords feed-category">
        
          <a href="/categories/#code" class="page__taxonomy-item p-category taxonomy-category" rel="tag">Code</a><span class="sep">, </span>
        
          <a href="/categories/#research" class="page__taxonomy-item p-category taxonomy-category" rel="tag">Research</a>
        
        </span>
      </span>
    


      
      
  </div>
</div>
        <h2 class="archive__item-title no_toc feed-title" itemprop="headline">
        
          <a href="/scatterplot-annotation/" rel="permalink">Scatterplot annotation
</a>
        
        </h2>
        


        <p class="archive__item-excerpt feed-excerpt" itemprop="description">Annotating scatterplots in R. Drawing polygons around point clusters using base functions and R packages ggplot, ggalt and ggforce.
</p>
      </div>
  </article>
</div>

      
      





<div class="grid__item feed-item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    
      <div class="archive-featured-small feed-image">
        <img src=/assets/images/posts/2019/2019-08-22-sweden-west-coast/featured.jpg alt="featured-image-small" class="archive-featured-image">
      </div>

      <div class="archive-text">
        <div class="archive-meta-content">
  <div class="archive-meta-content-sub">
    
    <!-- date -->
    
    
      <span class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> </strong> <time class="dt-published feed-date" datetime="2019-08-22T00:00:00+02:00">22 Aug 2019</time></span>
    

    <!-- separator-->
    
    <span class="separator">
      •
    </span>
    

    <!-- categories -->
      
      
      
    
    
      
    
      <span>
        <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i>  </strong>
        <span itemprop="keywords" class="category-keywords feed-category">
        
          <a href="/categories/#photography" class="page__taxonomy-item p-category taxonomy-category" rel="tag">Photography</a><span class="sep">, </span>
        
          <a href="/categories/#travel" class="page__taxonomy-item p-category taxonomy-category" rel="tag">Travel</a>
        
        </span>
      </span>
    


      
      
  </div>
</div>
        <h2 class="archive__item-title no_toc feed-title" itemprop="headline">
        
          <a href="/sweden-west-coast/" rel="permalink">Exploring the Swedish west coast
</a>
        
        </h2>
        


        <p class="archive__item-excerpt feed-excerpt" itemprop="description">A road trip exploring the west coast of Sweden.
</p>
      </div>
  </article>
</div>

      
      





<div class="grid__item feed-item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    
      <div class="archive-featured-small feed-image">
        <img src=/assets/images/posts/2019/2019-06-30-portugal/featured.jpg alt="featured-image-small" class="archive-featured-image">
      </div>

      <div class="archive-text">
        <div class="archive-meta-content">
  <div class="archive-meta-content-sub">
    
    <!-- date -->
    
    
      <span class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> </strong> <time class="dt-published feed-date" datetime="2019-06-30T00:00:00+02:00">30 Jun 2019</time></span>
    

    <!-- separator-->
    
    <span class="separator">
      •
    </span>
    

    <!-- categories -->
      
      
      
    
    
      
    
      <span>
        <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i>  </strong>
        <span itemprop="keywords" class="category-keywords feed-category">
        
          <a href="/categories/#photography" class="page__taxonomy-item p-category taxonomy-category" rel="tag">Photography</a><span class="sep">, </span>
        
          <a href="/categories/#travel" class="page__taxonomy-item p-category taxonomy-category" rel="tag">Travel</a>
        
        </span>
      </span>
    


      
      
  </div>
</div>
        <h2 class="archive__item-title no_toc feed-title" itemprop="headline">
        
          <a href="/portugal/" rel="permalink">Road trip through Portugal
</a>
        
        </h2>
        


        <p class="archive__item-excerpt feed-excerpt" itemprop="description">A conference and road trip through Portugal.
</p>
      </div>
  </article>
</div>

      
    </div>
  </div>
  
  
</div>


<script>
  document
    .querySelector('.article-content')
    .querySelectorAll('pre.highlight')
    .forEach(function(pre) {
      var button = document.createElement('button');
      var copyText = 'Copy';
      button.className = 'code-copy';
      button.type = 'button';
      button.ariaLabel = 'Copy code to clipboard';
      button.innerText = copyText;
      button.addEventListener('click', function() {
        var code = pre.querySelector('code').innerText.trim();
        navigator.clipboard.writeText(code);
        button.innerText = 'Copied';
        setTimeout(function() {
          button.innerText = copyText;
        }, 4000);
      });
      //pre.appendChild(button);
      pre.insertBefore(button, pre.firstChild);
    });
</script>
      </div>
    </div>


    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2015 - 2022 Roy Francis. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-66208341-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-66208341-1', { 'anonymize_ip': true});
</script>






    
  <script>
    var disqus_config = function () {
      this.page.url = "https://royfrancis.com/fast-ld-computation-from-vcf-files-using-tomahawk/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/fast-ld-computation-from-vcf-files-using-tomahawk"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://romf.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
